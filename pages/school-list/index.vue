<template>
    <div id="school-list">
      <h1>school list</h1>
      <v-divider/>
      <v-row class="mt-3">
  <!--      <v-col cols="10">-->
  <!--        <v-text-field-->
  <!--          v-model="search"-->
  <!--          label="Search"-->
  <!--          class="mx-4"-->
  <!--          @keyup="searchData()"-->
  <!--        ></v-text-field>-->
  <!--      </v-col>-->
  
      </v-row>
  
      <v-simple-table>
        <thead>
        <tr>
          <th>
            استان
          </th>
          <th>
              ناحیه
          </th>
          <th>
            استیج
          </th>
          <th>
            نام مدرسه
          </th>
          <th>
            نام مدرسه ثانویه
          </th>
        </tr>
        </thead>
        <tbody>
        <tr class="mt-12 mb-12 " v-if="table_loading">
          <td colspan="3" class="text-center ">
            <v-progress-circular
              :size="40"
              class="my-10"
              :width="3"
              color="orange"
              indeterminate
            ></v-progress-circular>
          </td>
        </tr>
        <tr v-else v-for="(school,index) in school_list" :key="index">
          <td>
            {{ school.stateTitle }}
          </td>
          <td>
            {{ school.regionTitle }}
          </td>
          <td>
            {{ school.stageTitle }}
          </td>
          <td>
            {{ school.schoolTitle }}
          </td>
          <td>
            {{ school.schoolTitle2 }}
          </td>
          <td>
           
  
            <v-btn icon
                   :to="'/school-list/edit/'+school.Id"
            >
              <v-icon small
                      class="mr-2">mdi-pencil
              </v-icon>
            </v-btn>
          </td>
        </tr>
  
        </tbody>
      </v-simple-table>
  
      <v-dialog
        v-model="deleteConfirmDialog"
        max-width="290"
      >
        <v-card>
          <v-card-title class="text-h5">
            Are you sure?
          </v-card-title>
  
          <v-card-text>
            Click AGREE if you are sure
          </v-card-text>
  
          <v-card-actions>
            <v-spacer></v-spacer>
  
            <v-btn
              text
              @click="deleteConfirmDialog = false"
            >
              Disagree
            </v-btn>
  
            <v-btn
              color="green darken-1"
              text
              :loading="delete_loading"
              @click="deletePage()"
            >
              Agree
            </v-btn>
          </v-card-actions>
        </v-card>
      </v-dialog>
  
  
      <div class="text-center" v-if="total_page>1">
        <v-pagination
          circle
          v-model="page"
          :length="total_page"
          total-visible="7"
        ></v-pagination>
      </div>
    </div>
  </template>
  
  <script>
  export default {
    layout: 'admin',
    auth:false,
    name: "school-mange",
    data() {
      return {
        total_page: 0,
        page: 1,
        table_loading: false,
  
        deleteConfirmDialog: false,
        delete_loading:false,
        delete_item:null,
  
        school_list: {}
      }
    },
    watch:{
      page(val){
        this.school_list=[];
        this.getList();
      }
    },
    mounted() {
      this.getList();
    },
    methods: {
      getList() {
        this.table_loading=true;
        this.$axios.$get('/test_api/school_list',{
            params:{
                page:this.page
            }
        })
          .then(response => {
            this.school_list = response.data;
            this.total_page=Math.ceil(response.total/response.per_page);
          }).catch(err => {
          console.log(err);
        }).finally(msg=>{
          this.table_loading=false;
        })
      },
     
    }
  
  }
  </script>
  
  <style scoped>
  #school-list{
    direction: rtl;
    
  }
  </style>
  